services:
  webserver:
    build: .                     # Build image from Dockerfile
    image: minitwit/myserver      # Name/tag of the image
    ports:
      - "5001:5000"              # Host port â†’ container port
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000"]  # Check if app is running
      interval: 30s              # Check every 30 seconds
      timeout: 10s               # Fail if no response in 10 seconds
      retries: 3                 # Mark unhealthy after 3 failures

  clidownload:
    image: appropriate/curl      # Simple container with curl
    depends_on:
      webserver:
        condition: service_healthy  # Wait until webserver is healthy
    entrypoint: sh -c "curl -s http://webserver:5000"  # Call the webserver

{{ define "title" }}
{{ if .IsPublic }}
Public Timeline
{{ else if .IsUser }}
{{ .ProfileUser.Username }}'s Timeline
{{ else }}
My Timeline
{{ end }}
{{ end }}

{{ define "body" }}
<h2>{{ if .IsPublic }}Public Timeline{{ else if .IsUser }}{{ .ProfileUser.Username }}'s Timeline{{ else }}My Timeline{{ end }}</h2>

{{ if .CurrentUser }}
  {{ if .IsUser }}
    <div class=followstatus>
      {{ if eq .CurrentUser.ID .ProfileUser.ID }}
        This is you!
      {{ else if .Followed }}
        You are currently following this user.
        <a class=unfollow href="/unfollow/{{ .ProfileUser.Username }}">Unfollow user</a>.
      {{ else }}
        You are not yet following this user.
        <a class=follow href="/follow/{{ .ProfileUser.Username }}">Follow user</a>.
      {{ end }}
    </div>
  {{ else if .IsTimeline }}
    <div class=twitbox>
      <h3>What's on your mind {{ .CurrentUser.Username }}?</h3>
      <form action="/add_message" method=post>
        <p><input type=text name=text size=60><!--
        --><input type=submit value="Share">
      </form>
    </div>
  {{ end }}
{{ end }}

<ul class=messages>
{{ range .Messages }}
  <li><img src="{{ gravatar .Email }}"><p>
    <strong><a href="/user/{{ .Username }}">{{ .Username }}</a></strong>
    {{ .Text }}
    <small>&mdash; {{ datetimeformat .PubDate }}</small>
  </p></li>
{{ else }}
  <li><em>There's no message so far.</em></li>
{{ end }}
</ul>
{{ end }}
